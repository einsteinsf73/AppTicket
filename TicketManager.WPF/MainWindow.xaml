<Window x:Class="TicketManager.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TicketManager.WPF"
        mc:Ignorable="d"
        Title="Gerenciador de Tickets" Height="600" Width="900">
    <DockPanel Margin="10">
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,10">
            <Button x:Name="NewTicketButton" Content="Novo Ticket" Margin="0,0,5,0" Padding="10,5" Click="NewTicketButton_Click"/>
            <Button x:Name="EditTicketButton" Content="Editar Ticket" Margin="0,0,5,0" Padding="10,5" Click="EditTicketButton_Click" IsEnabled="False"/>
            <Button x:Name="ReopenTicketButton" Content="Reabrir Ticket" Margin="0,0,5,0" Padding="10,5" Click="ReopenTicketButton_Click" IsEnabled="False"/>
            <Button x:Name="DeleteTicketButton" Content="Excluir Ticket" Padding="10,5" Click="DeleteTicketButton_Click"/>

            <Separator Margin="10,0"/>

            <Button x:Name="ExportButton" Content="Exportar para Excel" Padding="10,5" Click="ExportButton_Click"/>

            <Separator Margin="10,0"/>

            <Button x:Name="SettingsButton" Content="Configurações" Padding="10,5" Click="SettingsButton_Click"/>
        </StackPanel>

        <StatusBar DockPanel.Dock="Bottom">
            <TextBlock x:Name="CurrentUserTextBlock"/>
        </StatusBar>

        <!-- Filter Bar -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,5,0,10">
            <Label Content="Filtros:" FontWeight="Bold" VerticalAlignment="Center"/>
            <Label Content="Status:" VerticalAlignment="Center" Margin="10,0,5,0"/>
            <ComboBox Name="StatusFilterComboBox" Width="120" VerticalAlignment="Center"/>
            <Label Content="Prioridade:" VerticalAlignment="Center" Margin="10,0,5,0"/>
            <ComboBox Name="PriorityFilterComboBox" Width="100" VerticalAlignment="Center"/>
            <Button Name="FilterButton" Content="Filtrar" Margin="10,0,5,0" Padding="10,2" Click="FilterButton_Click"/>
            <Button Name="ClearFilterButton" Content="Limpar" Padding="10,2" Click="ClearFilterButton_Click"/>
        </StackPanel>

        <DataGrid Name="TicketsGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionChanged="TicketsGrid_SelectionChanged" MouseDoubleClick="TicketsGrid_MouseDoubleClick">
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <!-- Tickets Abertos -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Status}" Value="Aberto"/>
                                <Condition Binding="{Binding Priority}" Value="Alta"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="LightCoral"/>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Status}" Value="Aberto"/>
                                <Condition Binding="{Binding Priority}" Value="Media"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="LightYellow"/>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Status}" Value="Aberto"/>
                                <Condition Binding="{Binding Priority}" Value="Baixa"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="LightGreen"/>
                        </MultiDataTrigger>
                        
                        <!-- Tickets Em Andamento (usaremos a mesma cor da prioridade) -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Status}" Value="EmAndamento"/>
                                <Condition Binding="{Binding Priority}" Value="Alta"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="LightCoral"/>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Status}" Value="EmAndamento"/>
                                <Condition Binding="{Binding Priority}" Value="Media"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="LightYellow"/>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Status}" Value="EmAndamento"/>
                                <Condition Binding="{Binding Priority}" Value="Baixa"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="LightGreen"/>
                        </MultiDataTrigger>

                        <!-- Tickets Fechados -->
                        <DataTrigger Binding="{Binding Status}" Value="Fechado">
                            <Setter Property="Background" Value="LightBlue"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                <DataGridTextColumn Header="Título" Binding="{Binding Title}" Width="*"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="120"/>
                <DataGridTextColumn Header="Prioridade" Binding="{Binding Priority}" Width="120"/>
                <DataGridTextColumn Header="SLA (min)" Binding="{Binding SlaMinutes}" Width="100"/>
                <DataGridTextColumn Header="Última Atualização" Binding="{Binding UpdatedAt, StringFormat='dd/MM/yyyy HH:mm'}" Width="160"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
